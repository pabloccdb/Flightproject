const net = require('net')
const debug = require('debug')('flight:server')

const port = normalizePort(process.env.PORT || '3000'); // Obtiene el puerto
const server = net.createServer((socket) => { // Crea un servidor TCP
    console.log(`Cliente conectado desde ${socket.remoteAddress}:${socket.remotePort}`);
    
    socket.write('Â¡ConexiÃ³n exitosa! ğŸš€\n');

    socket.on('data', (data) => {
        console.log(`Datos recibidos: ${data}`);
        socket.write(`Recibido: ${data}`);
    });

    socket.on('end', () => {
        console.log('Cliente desconectado');
    });
});

server.listen(port, () => {
    console.log(`Servidor escuchando en el port:${port} ğŸš€`);
});

function normalizePort(val) {
    const port = parseInt(val, 10);
    if (isNaN(port)) {
        // named pipe
        return val;
    }
    if (port >= 0) {
        // port number
        return port;
    }
    return false;
}
